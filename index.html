// تبديل التبويبات
document.querySelectorAll('.tab-link').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        document.querySelectorAll('.tab-link').forEach(tab => tab.classList.remove('active'));
        this.classList.add('active');
        document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active-tab'));
        document.getElementById(this.getAttribute('data-tab')).classList.add('active-tab');
    });
});

// تحميل المدخلات عند بدء الصفحة
window.onload = function() {
    loadEntries();
    loadProfile();
};

// حفظ اليوميات
document.getElementById('diary-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const entry = {
        date: document.getElementById('entry-date').value,
        time: document.getElementById('entry-time').value,
        title: document.getElementById('entry-title').value,
        content: document.getElementById('entry-content').value,
        goals: document.getElementById('entry-goals').value
    };
    let entries = JSON.parse(localStorage.getItem('diaryEntries')) || [];
    entries.push(entry);
    localStorage.setItem('diaryEntries', JSON.stringify(entries));
    addNewEntry(entry);
    alert('تم حفظ اليوميات!');
    this.reset();
});

// حفظ الملف الشخصي
document.getElementById('profile-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const profile = {
        name: document.getElementById('user-name').value,
        bio: document.getElementById('user-bio').value,
        goals: document.getElementById('user-goals').value
    };
    localStorage.setItem('userProfile', JSON.stringify(profile));
    alert('تم تحديث الملف الشخصي!');
});

// تحميل المدخلات
function loadEntries() {
    const entries = JSON.parse(localStorage.getItem('diaryEntries')) || [];
    entries.forEach(entry => addNewEntry(entry));
}

// تحميل الملف الشخصي
function loadProfile() {
    const profile = JSON.parse(localStorage.getItem('userProfile'));
    if (profile) {
        document.getElementById('user-name').value = profile.name || '';
        document.getElementById('user-bio').value = profile.bio || '';
        document.getElementById('user-goals').value = profile.goals || '';
    }
}

// إضافة مدخل جديد
function addNewEntry(entry) {
    const entriesList = document.getElementById('entries-list');
    const dateObj = new Date(entry.date);
    const formattedDate = dateObj.toLocaleDateString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric' });
    const timeParts = entry.time.split(':');
    const formattedTime = `${timeParts[0]}:${timeParts[1]} ${timeParts[0] >= 12 ? 'مساءً' : 'صباحاً'}`;
    const entryDiv = document.createElement('div');
    entryDiv.className = 'entry';
    entryDiv.innerHTML = `
        <div class="entry-header">
            <span class="entry-title">${entry.title}</span>
            <span class="entry-date">${formattedDate} - ${formattedTime}</span>
        </div>
        <div class="entry-content">
            <p>${entry.content}</p>
        </div>
        ${entry.goals ? `<div class="entry-goals"><p><strong>أهداف اليوم:</strong> ${entry.goals}</p></div>` : ''}
    `;
    entriesList.prepend(entryDiv);
}
